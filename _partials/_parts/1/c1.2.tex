
%%\chapterimage{ima2} % Chapter heading image

\chapter{Neuron Models}\

Spiking neural network's neuron model describe how the membrance potential of a neuron change over the time.
In this chapter, we dive into the biological neuron's dynamics and exhibit several examples neuron models in the 
spiking neural network. 

% Beside classical neuron models such as 
% \texttt{Hodgkin-Huxley (HH) model}, \texttt{Leaky integrate-and-fire model}, and \texttt{Zhikevich model},
% we also describe some 

\section{Biological Neuron}\index{Biological Neuron}


\section{Abstract of Neuron Models}\index{Abstract of Neuron Models}
In spiking neural network, Equation~\ref{eq:neuron-state-space-abstract-1} to
Equation~\ref{eq:neuron-state-space-abstract-4} in the form of \textbf{state-space models (SMMs)}.
provide a highly abstract description for describe a biological neuron.

In these equation, $\bold x(t)$ is the state vector at time $t$, $\dot x(t)$ is the state variation at time 
$t$, $\bold I(t)$ is the input current at time $t$, $V$ is the membrane potential of the neuron, 
$\bold y(t)$ is the neuron's output at time $t$, and $V_{out}$ is the output voltage tha will be sent to the 
synapses that depature from this neuron. 
$(\bold x(t))_{i}$ is the $i$-th element of the state vector. $\mathcal P$ is the model parameters.

\begin{align}
    \dot {\bold x}(t) = f(\bold x(t), \bold I(t), t, \mathcal P) \label{eq:neuron-state-space-abstract-1}  \\
    \bold y(t) = g(\bold x(t), \bold I(t), t, \mathcal P) \label{eq:neuron-state-space-abstract-2} \\
    s.t.,\; (\exists i \in [0, |\bold x(t)|])(\bold x({t}))_{i} = V(t) \label{eq:neuron-state-space-abstract-3} \\
            (\exists i \in [0, |\bold y(t)|])_i\bold y(t) = V_{out}(t) \label{eq:neuron-state-space-abstract-4}
\end{align}


Equation~\ref{eq:neuron-state-space-abstract-3} indicates that, a neuron should maintain a membrane potential $V$, 
and Equation~\ref{eq:neuron-state-space-abstract-4} indicates that, the neuron's output should contains a 
voltage $V_{out}$.

A discretization version present in Equation~\ref{eq:discrete-neuron-state-space-abstract-1} to 
Equation~\ref{eq:discrete-neuron-state-space-abstract-4}.

\begin{align}
    {\bold x}_{t + 1} = f(\bold x_t, \bold I_t, t, \mathcal P) \label{eq:discrete-neuron-state-space-abstract-1}  \\
    \bold y_t = g(\bold x_t, \bold I_t, t, \mathcal P) \label{eq:discrete-neuron-state-space-abstract-2} \\
    s.t.,\; (\exists i \in [0, |\bold x_t|])(\bold x_{t})_{i} = V_t \label{eq:discrete-neuron-state-space-abstract-3} \\
            (\exists i \in [0, |\bold y_t|])_i\bold y = V_{out_t} \label{eq:discrete-neuron-state-space-abstract-4}
\end{align}


\section{Neuron Model Examples}\index{Neuron Model Examples}
\subsection{Hodgkin-Huxley (HH) Model}\index{Hodgkin-Huxley (HH) Model}

The Hodgkin-Huxley (HH) model can be utilize to accurately 
reproduce the bio-neuron's dynamics. Its mathematical formulation is presented in
Equations~\ref{eq:hh-model-1} to~\ref{eq:hh-model-5}.
By combining all these equations, we arrive at Equation~\ref{eq:hh-model-6}.

\begin{align}
    I(t) = C_m\frac{dV_m(t)}{dt} + I_{i}(t) \label{eq:hh-model-1} \\
    I_i(t) = I_{Na}(t) + I_K(t) + I_l(t) \label{eq:hh-model-2}  \\
    I_{Na}(t) = g_{Na}(t)(V_m(t) - V_{Na}(t)) \label{eq:hh-model-3} \\
    I_K(t) = g_{K}(t)(V_m(t) - V_{K}(t)) \label{eq:hh-model-4}  \\
    I_l(t) = \bar g_{l}(t)(V_m(t) - V_{l}(t)) \label{eq:hh-model-5} 
\end{align}

\begin{equation}\label{eq:hh-model-6}
    I(t) = C_m\frac{dV_m(t)}{dt} + g_{Na}(t)(V_m(t) - V_{Na}(t)) + g_{K}(V_m(t) - V_{K}(t)) + 
        \bar g_{l}(t)(V_m(t) - V_{l}(t))
\end{equation}

Ion channel function $g_{\cdot}$ are function respect to time $t$ and membrance potential $V$.
Specifically, Equation~\ref{eq:hh-model-7} is held.

\begin{equation}\label{eq:hh-model-7}
    g_{Na}(t) = \bar g_{Na}m^3(t)h(t) \\
    g_{K}(t) = \bar g_{K}n^4(t) \\
    g_{l}(t) = \bar g_l \\
\end{equation}

By combining Equations~\ref{eq:hh-model-1} to~\ref{eq:hh-model-7}, we arrive at Equation~\ref{eq:hh-model-8}.
\begin{equation}\label{eq:hh-model-8}
    I = C_m\frac{dV_m(t)}{dt} + \bar g_{Na}(t)m^3(t)h(t)(V_m(t) - V_{Na}(t)) + 
    \bar g_{K}(t)n^4(t)(V_m(t) - V_{K}(t)) + \bar g_{l}(t)(V_m(t) - V_{l}(t))
\end{equation}

$\frac{d\cdot}{dt}= \alpha_\cdot(V_m)(1-\cdot)-\beta_\cdot(V_m)\cdot $ is held. 
In which, $\cdot$ is a placeholder for $m(t)$, $n(t)$ and $h(t)$. As such, Equation~\ref{eq:hh-model-9} to 
Equation~\ref{eq:hh-model-11} are held.

\begin{align}
    \frac{dn(t)}{dt}= \alpha_n(V_m(t))(1-n(t))-\beta_n(V_m(t))n(t) \label{eq:hh-model-9}  \\
    \frac{dm(t)}{dt}= \alpha_m(V_m(t))(1-m(t))-\beta_m(V_m(t))m(t) \label{eq:hh-model-10} \\
    \frac{dh(t)}{dt}= \alpha_h(V_m(t))(1-h(t))-\beta_h(V_m(t))h(t) \label{eq:hh-model-11} \\
\end{align}

From experiment, Equation~\ref{eq:hh-model-12} to Equation~\ref{eq:hh-model-17} were obtained.

\begin{align}
    \alpha_n(V_m(t)) = \frac{0.01(10 - V_m(t))}{exp(\frac{10-V_m(t)}{10}) - 1} \label{eq:hh-model-12}\\
    \alpha_m(V_m(t)) = \frac{0.1(25 - V_m(t))}{exp(\frac{25-V_m(t)}{10}) - 1} \label{eq:hh-model-13}\\
    \alpha_h(V_m(t)) = 0.07exp(-\frac{V_m(t)}{20}) \label{eq:hh-model-14}\\
    \beta_n(V_m(t)) = 0.125exp(-\frac{V_m(t)}{80}) \label{eq:hh-model-15}\\
    \beta_m(V_m(t)) = 4exp(-\frac{V_m(t)}{18}) \label{eq:hh-model-16}\\
    \beta_h(V_m(t)) = \frac{1}{exp(\frac{30-V_m(t)}{10})+1} \label{eq:hh-model-17}
\end{align}

Finally, we write the state-space model representation from Equation~\ref{eq:smm-hh-1} to 
Equation~\ref{eq:smm-hh-8} for Hodgkin-Huxley model.

\begin{align}
    x(t) = \begin{bmatrix}V_m(t) & n(t) & m(t) & h(t)\end{bmatrix} \label{eq:smm-hh-1}\\
    \dot x(t) = \begin{bmatrix}\dot V_m(t) & \dot n(t) & \dot m(t) & \dot h(t)\end{bmatrix}\label{eq:smm-hh-2} \\
    \dot V_m(t) = -\frac{1}{C_m}(\bar g_Kn^4(t)(V_m(t)-V_K)+\bar g_{Na}m^3(t)h(t)+\bar g_l(V_m(t)-V_l(t)) - I(t)) \label{eq:smm-hh-4}\\
    \dot n(t)= \alpha_n(V_m(t))(1-n(t))-\beta_n(V_m(t))n(t) \label{eq:smm-hh-5}\\
    \dot m(t)= \alpha_m(V_m(t))(1-m(t))-\beta_m(V_m(t))m(t) \label{eq:smm-hh-6}\\
    \dot h(t)= \alpha_h(V_m(t))(1-h(t))-\beta_h(V_m(t))h(t) \label{eq:smm-hh-7}\\
    V_out(t) = V_m(t) \label{eq:smm-hh-8}
\end{align}


\subsection{Leaky Integrate-and-fire Model}\index{Leaky Integrate-and-fire Model}
\label{sec:current-based-lif}
Leaky Integrate-and-fire model is a computational effective model, 
in which a threshold is set, when membrance potential cross the threshold, 
the neuro emit a spike. 
In implementation, we may set the voltage output at time $t$, $V_{out}$ be $1\;mV$. 
The scale problem has the potential to be solved by automatically adjusting the synapses' weights 
in trainning.
A LIF neuron $i$'s output form a \textbf{spike train} $S_{i}(t) = \sum_{m}\delta(t-t_m)$.

\begin{equation}\label{eq:lif}
    \dot V_t = \frac{1}{\tau_m}(-(V_t-V_{rest})+g_syn(t)(E_{syn}-V_t))
\end{equation}

%% Learning neuron, synapse models and the spike trainning method.
%% try on real dataset.

\subsection{Izhikevich Model}\index{Izhikevich Model}

% \subsection{Introducción}\index{Introducción}

\subsection{FitzHugh-Nagumo Model}\index{FitzHugh-Nagumo Model}

\subsection{Morris-Lecar Model}\index{Morris-Lecar Model}

\subsection{Hindmarsh-Rose Model}\index{Hindmarsh-Rose Model}

\subsection{Cable theory}\index{Cable theory}

\subsection{Perfect Integrate-and-fire}\index{Perfect Integrate-and-fire}

\subsection{Adaptive Integrate-and-fire}\index{Adaptive Integrate-and-fire}

\subsection{Fring Rate Model}\index{Firing Rate Model}

\subsection{Discussion}\index{Discussion (Neuron Dynamics)}

\textbf{Spike Representation}
You may note that, although different neuron models have different dynamics and spike 
representations, they can still communicate with each other through synapses. Some neuron
 models require current input, while others do not. Nonetheless, spikes can transmit 
 over synapses and cause current variations across them by utilizing a common output element $V_{out}$. 
 
 One challenge that may arise is the normalization of spike representations.
To address this issue, one approach is to standardize the spike events by converting all
 spike representations into binary form. Another approach can involve adjusting the synaptic weights.
  Although we may face scaling issues with different types of spike representations, these
   can be mitigated during training by appropriately adjusting the synapse weights.


